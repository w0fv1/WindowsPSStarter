# **Starter ä»»åŠ¡ç®¡ç†è„šæœ¬**

## **ğŸ“Œ é¡¹ç›®ç®€ä»‹**
**Starter** æ˜¯ä¸€ä¸ªç”¨äº **Windows** çš„ **è½»é‡çº§ä»»åŠ¡ç®¡ç†è„šæœ¬**ï¼Œå¯ä»¥è‡ªåŠ¨è¿è¡Œå’Œç®¡ç† **åå° PowerShell ä»»åŠ¡**ï¼Œå¹¶åœ¨è¿›ç¨‹æ„å¤–é€€å‡ºæ—¶è‡ªåŠ¨é‡å¯ã€‚  

æœ¬é¡¹ç›®é€‚ç”¨äºï¼š
- **è¿è¡Œå®šæ—¶ä»»åŠ¡**
- **ç®¡ç†åå°è¿›ç¨‹**
- **ç›‘æ§å’Œé‡å¯å…³é”®ä»»åŠ¡**
- **æä¾› Windows å¼€æœºè‡ªå¯çš„ä»»åŠ¡æ”¯æŒ**

### **ğŸš€ ä¸»è¦åŠŸèƒ½**
âœ… **è‡ªåŠ¨æ³¨å†Œ Windows è®¡åˆ’ä»»åŠ¡**ï¼Œåœ¨å¼€æœºåè‡ªåŠ¨è¿è¡Œ  
âœ… **æ”¯æŒå¤šä»»åŠ¡ç®¡ç†**ï¼Œå¯ä»¥å¹¶è¡Œè¿è¡Œå¤šä¸ª PowerShell ä»»åŠ¡  
âœ… **ä»»åŠ¡å¼‚å¸¸é€€å‡ºæ—¶è‡ªåŠ¨é‡å¯**ï¼Œç¡®ä¿é•¿æœŸè¿è¡Œ  
âœ… **åå°é™é»˜è¿è¡Œ**ï¼Œä¸ä¼šå¼¹å‡ºå¹²æ‰°ç”¨æˆ·çš„çª—å£  
âœ… **ç®€å•è½»é‡**ï¼Œæ— éœ€é¢å¤–å®‰è£…å¤æ‚çš„è½¯ä»¶  

---

## **ğŸ› ï¸ å®‰è£…ä¸ä½¿ç”¨**

### **1ï¸âƒ£ ä¸‹è½½æˆ–å…‹éš†æœ¬é¡¹ç›®**
```sh
git clone https://github.com/your-username/starter-service.git
cd starter-service
```
æˆ–è€…ç›´æ¥[ä¸‹è½½ ZIP](https://github.com/your-username/starter-service/archive/refs/heads/main.zip)ï¼Œç„¶åè§£å‹åˆ°ä»»æ„ç›®å½•ã€‚

---

### **2ï¸âƒ£ é…ç½®ä»»åŠ¡**
æ‰€æœ‰ä»»åŠ¡é…ç½®å‡åœ¨ `starter.ps1` ä¸­ã€‚æ‰“å¼€ `starter.ps1`ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ ¼å¼ **æ·»åŠ ä½ çš„ä»»åŠ¡**ï¼š
```powershell
$tasks = @(
    @{ Name = "ä»»åŠ¡1"; Command = "while ($true) { Write-Host 'è¿è¡Œä»»åŠ¡1'; Start-Sleep -Seconds 5 }" }
    @{ Name = "ä»»åŠ¡2"; Command = "Write-Host 'æ‰§è¡Œä¸€æ¬¡æ€§ä»»åŠ¡2'" }
)
```
**ç¤ºä¾‹è§£é‡Šï¼š**
- **ä»»åŠ¡ 1** ä¼šæŒç»­è¿è¡Œï¼Œæ¯ 5 ç§’è¾“å‡º `"è¿è¡Œä»»åŠ¡1"`ã€‚
- **ä»»åŠ¡ 2** åªæ˜¯æ‰§è¡Œä¸€æ¬¡ `"æ‰§è¡Œä¸€æ¬¡æ€§ä»»åŠ¡2"`ï¼Œç„¶åé€€å‡ºã€‚

**âš ï¸ é‡è¦**ï¼šæ‰€æœ‰ä»»åŠ¡éƒ½å¿…é¡»ç”¨ `@{}` ç»“æ„å®šä¹‰ï¼Œ`Command` ä¸­å†™ **PowerShell ä»£ç **ã€‚

---

### **3ï¸âƒ£ æ³¨å†Œå¹¶è¿è¡Œä»»åŠ¡**
**âš ï¸ é‡è¦**ï¼š**å¿…é¡»ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼**

#### **æ–¹æ³• 1ï¼šè¿è¡Œ `register.bat`**
- **å³é”® `register.bat`** â†’ é€‰æ‹© **"ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ"**ã€‚
- è¿™å°†æ³¨å†Œä¸€ä¸ª Windows è®¡åˆ’ä»»åŠ¡ï¼Œä½¿ `starter.ps1` åœ¨æ¯æ¬¡å¼€æœºåè‡ªåŠ¨è¿è¡Œã€‚

#### **æ–¹æ³• 2ï¼šæ‰‹åŠ¨è¿è¡Œå‘½ä»¤**
```powershell
Start-Process cmd.exe -Verb RunAs -ArgumentList "/c register.bat"
```
å¦‚æœä½ åªæ˜¯æƒ³æ‰‹åŠ¨æµ‹è¯• `starter.ps1`ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œï¼š
```powershell
powershell.exe -ExecutionPolicy Bypass -File .\starter.ps1
```

---

### **4ï¸âƒ£ ç¡®ä¿ä»»åŠ¡æ­£å¸¸è¿è¡Œ**
æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å·²æ³¨å†Œï¼š
```sh
schtasks /Query /TN "StarterTask"
```
å¦‚æœè¾“å‡ºå¦‚ä¸‹ï¼Œåˆ™è¯´æ˜ä»»åŠ¡å·²æ³¨å†ŒæˆåŠŸï¼š
```
ä»»åŠ¡åç§°: StarterTask
ä¸‹æ¬¡è¿è¡Œæ—¶é—´: 2025/03/19 10:00:00
ä»»åŠ¡çŠ¶æ€: å‡†å¤‡å°±ç»ª
```

**æ£€æŸ¥ Starter æ˜¯å¦åœ¨åå°è¿è¡Œ**
```powershell
Get-Process -Name powershell
```
å¦‚æœ `starter.ps1` åœ¨è¿è¡Œï¼Œä¼šçœ‹åˆ°å¤šä¸ª `powershell.exe` è¿›ç¨‹ã€‚

---

## **ğŸ”„ ä»»åŠ¡ç®¡ç†**

### **âœ… å¦‚ä½•ä¿®æ”¹ä»»åŠ¡ï¼Ÿ**
1. æ‰“å¼€ `starter.ps1`ï¼Œæ‰¾åˆ° `$tasks` å˜é‡ã€‚
2. æ·»åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹ä»»åŠ¡å†…å®¹ï¼Œä¾‹å¦‚ï¼š
   ```powershell
   $tasks = @(
       @{ Name = "NewTask"; Command = "while ($true) { Write-Host 'æ–°ä»»åŠ¡'; Start-Sleep -Seconds 10 }" }
   )
   ```
3. é‡æ–°å¯åŠ¨ Starterï¼š
   ```powershell
   Restart-Service -Name Starter
   ```

---

### **ğŸ›‘ å¦‚ä½•åœæ­¢æˆ–åˆ é™¤ Starterï¼Ÿ**
å¦‚æœä¸å†éœ€è¦ `Starter`ï¼Œå¯ä»¥åˆ é™¤è®¡åˆ’ä»»åŠ¡ï¼š
```sh
schtasks /Delete /TN "StarterTask" /F
```
è¿™æ · `starter.ps1` å°†ä¸ä¼šåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œã€‚

---

### **ğŸ”„ ä»»åŠ¡å´©æºƒåè‡ªåŠ¨é‡å¯**
`run.ps1.bat` é‡‡ç”¨äº† **è¿›ç¨‹æ£€æµ‹æœºåˆ¶**ï¼Œç¡®ä¿ä»»åŠ¡æ„å¤–é€€å‡ºåè‡ªåŠ¨é‡å¯ï¼š
```batch
:check
timeout /t 5 >nul
tasklist | findstr /i "powershell.exe" >nul
if %errorlevel% neq 0 (
    echo PowerShell process not found, restarting...
    PowerShell.exe -NoProfile -ExecutionPolicy Bypass -File "%PowershellFilePath%" -WindowStyle Hidden
)
goto check
```
ä½ æ— éœ€ä»»ä½•é¢å¤–æ“ä½œï¼Œ**Starter ä¼šè‡ªåŠ¨ç¡®ä¿ä»»åŠ¡æŒç»­è¿è¡Œ**ã€‚

---

## **ğŸ“œ å¸¸è§é—®é¢˜ (FAQ)**

### **â“ `starter.ps1` æ²¡æœ‰è¿è¡Œæ€ä¹ˆåŠï¼Ÿ**
1. **æ£€æŸ¥ä»»åŠ¡æ˜¯å¦æ­£ç¡®æ³¨å†Œ**
   ```sh
   schtasks /Query /TN "StarterTask"
   ```
   å¦‚æœä»»åŠ¡ä¸å­˜åœ¨ï¼Œè¿è¡Œ `register.bat` é‡æ–°æ³¨å†Œã€‚

2. **æ‰‹åŠ¨è¿è¡Œ Starter**
   ```powershell
   powershell.exe -ExecutionPolicy Bypass -File .\starter.ps1
   ```

---

### **â“ `starter.ps1` è¿è¡Œåè‡ªåŠ¨å…³é—­**
- **å¯èƒ½æ˜¯ä»»åŠ¡è„šæœ¬ç»“æŸäº†**ï¼Œå¦‚æœä»»åŠ¡æ˜¯ä¸€æ¬¡æ€§çš„ï¼ˆéå¾ªç¯è¿è¡Œï¼‰ï¼ŒStarter å¯èƒ½ä¼šé€€å‡ºã€‚ç¡®ä¿ `Command` å†…éƒ¨æœ‰ `while ($true)` è¿™æ ·çš„å¾ªç¯é€»è¾‘ï¼š
  ```powershell
  @{ Name = "Task1"; Command = "while ($true) { Write-Host 'ä¿æŒè¿è¡Œ'; Start-Sleep -Seconds 5 }" }
  ```

- **æ£€æŸ¥ä»»åŠ¡è®¡åˆ’æ—¥å¿—**
  ```sh
  wevtutil qe Microsoft-Windows-TaskScheduler/Operational /f:text /c:10
  ```

---

## **ğŸ“œ è®¸å¯è¯**
æœ¬é¡¹ç›®éµå¾ª **MIT License**ï¼Œå¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘ã€‚

---

## **ğŸ™Œ è´¡çŒ®**
æ¬¢è¿å¤§å®¶æå‡º **issues** æˆ– **pull requests**ï¼Œä¸€èµ·å®Œå–„è¿™ä¸ªé¡¹ç›®ï¼ğŸš€

---
#### **ğŸ“§ è”ç³»æ–¹å¼**
å¦‚æœæœ‰é—®é¢˜ï¼Œæ¬¢è¿åœ¨ GitHub ä¸Šæäº¤ Issue æˆ–è”ç³»ä½œè€…ã€‚